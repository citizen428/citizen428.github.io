<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: programming | citizen428.blog()]]></title>
  <link href="http://citizen428.net/blog/categories/programming/atom.xml" rel="self"/>
  <link href="http://citizen428.net/"/>
  <updated>2012-04-22T13:28:25+02:00</updated>
  <id>http://citizen428.net/</id>
  <author>
    <name><![CDATA[Michael Kohl]]></name>
    <email><![CDATA[citizen428@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Information Overload 2012-04-15]]></title>
    <link href="http://citizen428.net/blog/2012/04/15/information-overload-2012-04-15/"/>
    <updated>2012-04-15T00:00:00+02:00</updated>
    <id>http://citizen428.net/blog/2012/04/15/information-overload-2012-04-15</id>
    <content type="html"><![CDATA[<ul>
<li><a href="http://www.insidehighered.com/views/2011/05/02/slavoj_zizek_essay_on_cloud_computing_and_privacy">Corporate Rule of Cyberspace</a><br>Philosopher <a href="http://en.wikipedia.org/wiki/Slavoj_%C5%BDi%C5%BEek">Slavoj Žižek</a> offers some thoughts on cloud computing. Some of the comments are interesting too.</li>
<li><a href="http://www.slate.com/articles/technology/future_tense/2012/03/narrative_science_robot_journalists_customized_news_and_the_danger_to_civil_discourse_.single.html">http://www.slate.com/articles/technology/future_tense/2012/03/narrative_science_robot_journalists_customized_news_and_the_danger_to_civil_discourse_.single.html</a><br>On automated journalism and the potential consequences for society.</li>
<li><a href="https://groups.google.com/group/comp.lang.forth/browse_thread/thread/4e15a2197c0aaafe/95c3f82d1c681296?#95c3f82d1c681296">A Forth Story...</a><br>This long text from 1995 is not only interesting because it talks about Forth, but also because of the history of programming in the 70s, 80s and 90s.</li>
<li><a href="http://www.economist.com/node/21552581">Giving divorce a bad name</a><br>South Sudan invaded an oil field in Sudan, which could lead to a fierce war. Make sure to read the comments too, there's some good stuff in there.</li>
<li><a href="http://www.wired.com/threatlevel/2012/04/code-not-physical-property/">Code Not Physical Property, Court Rules in Goldman Sachs Espionage Case</a><br>An update on the Aleynikov vs Goldman Sachs case.</li>
<li><a href="http://www.technologyreview.com/blog/arxiv/27730">Computer Scientists Build Computer Using Swarms of Crabs</a><br>A computer exploiting the swarming behavior of soldier crabs. Ok, maybe just a function OR gate, but still rather cool.</li>
<li><a href="http://www.physicscentral.com/buzz/blog/index.cfm?postid=4656335810518469535">Physicist Uses Math to Beat Traffic Ticket</a><br>Who says math can't be useful in your daily life? ;-)</li>
<li><a href="http://derstandard.at/1334132541612/Strassengangs-Rosen-aus-dem-Beton">Rosen aus dem Beton</a><br>About street gangs and gang related violence in Los Angeles (in German).</li>
<li><a href="http://www.antipope.org/charlie/blog-static/2012/04/understanding-amazons-strategy.html">What Amazon's ebook strategy means</a><br>Wether you agree with Charlie Stross or not, his posts are usually well written and provide food for thought.</li>
<li><a href="http://www.guardian.co.uk/sport/2012/apr/13/olympics-2012-branding-police-sponsors">Olympics 2012: branding 'police' to protect sponsors' exclusive rights</a><br>Brave new corporate world.</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Information Overload 2012-01-22]]></title>
    <link href="http://citizen428.net/blog/2012/01/22/information-overload-2012-01-22/"/>
    <updated>2012-01-22T00:00:00+01:00</updated>
    <id>http://citizen428.net/blog/2012/01/22/information-overload-2012-01-22</id>
    <content type="html"><![CDATA[<p><blockquote><p>We defeat SOPA today, only to face it again tomorrow. It's like trying to stop a cold by blowing your nose. It's time we go after the virus.</p><footer><strong>Maddox</strong> <cite><a href='http://maddox.xmission.com/'>I Hope SOPA Passes</a></cite></footer></blockquote></p>

<ul>
<li><a href="https://werebuild.eu/wiki/Blue_cabinet">Blue cabinet</a><br>A project that wants "to name, shame and expose those who profit on selling the surveillance equipment that enables the intimidation, harassment and killing of innocent people".</li>
<li><a href="http://acko.net/blog/making-love-to-webkit/">Making Love To WebKit</a><br><a href="http://acko.net">Acko.net</a> always had awesome design, but his newest one is absolutely mindblowing.</li>
<li><a href="http://www.tangledwilderness.org/pdfs/saidthepottothekettle-web.pdf">said the pot to the kettle</a><br>This PDf subtitled "feminist theory for anarchist men" is a good read for everyone who's interested in overcoming antiquated gender stereotypes, be they male or female.</li>
<li><a href="http://maddox.xmission.com/">I hope SOPA passes</a><br>Typical Maddox style.</li>
<li><a href="http://jeffdechambeau.com/friending-fast-and-slow.html">Behavioral economics and facebook conspiracy theories</a><br>While the author talks about a conspiracy theory, I think it's fair to assume that the big web companies do use behavioral psychology when trying to get us to click on ads.</li>
<li><a href="http://www.guardian.co.uk/world/2012/jan/20/iran-war-brewing-simon-tisdall">An Iran war is brewing from mutual ignorance and chronic miscalculation</a><br>I still have the naive hope that war is evitable.</li>
<li><a href="http://www.spiegel.de/netzwelt/netzpolitik/0,1518,773495,00.html">US-Copyright-Cops greifen weltweit zu</a><br>If you have German speaking friends who you want to educate about SOPA/PIPA, point them to this article by "Der Spiegel".</li>
<li><a href="http://prezi.com/2lanmqb0nnkj/paredit-emacs-minor-mode/">Paredit - emacs minor mode</a><br>A neat presentation on Paredit, a great Emacs minor mode for Lisp hackers.</li>
<li><a href="http://www.mcsweeneys.net/articles/in-which-i-fix-my-girlfriends-grandparents-wifi-and-am-hailed-as-a-conquering-hero">In Which I Fix My Girlfriend’s Grandparents’ WIFI And Am Hailed As A Conquering Hero.</a><br>We've all been there, but this is brilliantly told.</li>
<li><a href="http://www.good.is/post/people-are-awesome-the-south-carolina-coffee-shop-where-everyone-pays-for-everyone-else-s-drinks">People Are Awesome: The Coffee Shop Where Everyone Pays for Everyone Else's Drinks</a><br>It's not often enough that I get to post something nice here.</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Information Overload 2012-01-08]]></title>
    <link href="http://citizen428.net/blog/2012/01/08/information-overload-2012-01-08/"/>
    <updated>2012-01-08T00:00:00+01:00</updated>
    <id>http://citizen428.net/blog/2012/01/08/information-overload-2012-01-08</id>
    <content type="html"><![CDATA[<ul>
<li><a href="https://www.eff.org/deeplinks/2011/12/newyears-resolution-full-disk-encryption-every-computer-you-own">New Year's Resolution: Full Disk Encryption on Every Computer You Own</a><br>The <a href="https://www.eff.org">EFF</a> has a great suggestion for a New Year's resolution.</li>
<li><a href="http://scienceblogs.com/goodmath/2008/12/my_favorite_strange_number_cla.php">My Favorite Strange Number: Ω</a><br>Yeah for obscure math.</li>
<li><a href="http://www.osnews.com/story/25469/Richard_Stallman_Was_Right_All_Along">Richard Stallman Was Right All Along</a><br>It's not often enough that one reads something positive about RMS, which frankly speaking is a shame.</li>
<li><a href="http://www.taz.de/Armenviertel-in-Caracas/!84778/">Zukunft in Selbstverwaltung</a><br>People in Venezuela's capital are organising themselves in order to take care of things the state fails to provide (in German).</li>
<li><a href="http://www.orgnet.com/slumlords.html">Uncloaking a Slumlord Conspiracy with Social Network Analysis</a><br>Using social network analysis for social justice.</li>
<li><a href="https://www.eff.org/deeplinks/2012/01/us-government-calls-censor-twitter-threaten-free-speech">U.S. Government Calls to Censor Twitter Threaten Free Speech</a><br>Yes, that's 2 articles by the EFF in one issue of the Information Overload. It's not my fault they write so much sensible stuff...</li>
<li><a href="http://www.gamasutra.com/view/feature/6582/learning_from_the_masters_level_.php">Learning From The Masters: Level Design In The Legend Of Zelda</a><br>See this as a kind of follow-up to another Zelda related article I posted not so long ago.</li>
<li><a href="http://www.technologyreview.com/blog/arxiv/27469/">Mathematicians Solve Minimum Sudoku Problem</a><br>Unfortunately this was proven by using a computer to brute force the problem space, much like the <a href="http://en.wikipedia.org/wiki/Four_color_theorem">Four Color Theorem</a>. A "proper" proof would be nice and I'm sure it would make for an interesting read.</li>
<li><a href="http://io9.com/5873485/an-optimistic-history-of-the-next-40-years">An Optimistic History of the Next 40 Years</a><br>That's certainly a more optimistic guess than anything I can come up with. Unfortunately I'm afraid this will stay the stuff for SciFi novels...</li>
<li><a href="http://www.salon.com/2012/01/03/david_lynch_why_brutality_makes_me_laugh/singleton/">David Lynch: Why brutality makes me laugh</a><br>An interview with David Lynch about his latest musical project.</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Information Overload 2012-01-01]]></title>
    <link href="http://citizen428.net/blog/2012/01/01/information-overload-2012-01-01/"/>
    <updated>2012-01-01T18:08:00+01:00</updated>
    <id>http://citizen428.net/blog/2012/01/01/information-overload-2012-01-01</id>
    <content type="html"><![CDATA[<p>The <a href="http://citizen428.net/blog/categories/informationoverload/">Information Overload</a> series started in August 2010 and I'm surprised that I really managed to keep it going on a weekly basis (I only skipped a couple of issues because of traveling). So here we go for the first post of 2012.</p>

<p><blockquote><p>As for accountability of teachers and administrators, Sahlberg shrugs. "There's no word for accountability in Finnish," he later told an audience at the Teachers College of Columbia University. "Accountability is something that is left when responsibility has been subtracted."</p><footer><strong>Anu Partanen</strong> <cite><a href='http://www.theatlantic.com/national/archive/2011/12/what-americans-keep-ignoring-about-finlands-school-success/250564/'>What Americans Keep Ignoring About Finland's School Success</a></cite></footer></blockquote></p>

<ul>
<li><a href="http://www.virgin.com/richard-branson/blog/time-to-end-the-war-on-drugs">Time to end the war on drugs</a><br>Richard Branson. Founder of Virgin Group, speaks out against the war on drugs.</li>
<li><a href="http://www.tagesspiegel.de/zeitung/korruption-in-wien-wo-war-mei-leistung/5980516.html">„Wo war mei Leistung?“</a><br>If you are not from Austria but can read German, this is a good summary of the rampant corruption in our country.</li>
<li><a href="http://www.foreignpolicy.com/articles/2011/12/19/a_few_of_kims_favorite_things?page=full">A Few of Kim's Favorite Things</a><br>Foreign Policy published this article on Kim Jong-Il's special tastes.</li>
<li><a href="http://www.nytimes.com/2011/12/14/technology/shunning-facebook-and-living-to-tell-about-it.htm">The Facebook Resisters</a><br>Some people live fine without Facebook, who'd have thought?</li>
<li><a href="http://www.grist.org/list/2011-12-29-how-india-is-winning-the-future-with-solar-energy">How India is winning the future with solar energy</a><br>A summary of India's plan to generate lots of solar power by 2020, including links to the source articles for further reading.</li>
<li><a href="http://www.aclu.org/blog/national-security/president-obama-signs-indefinite-detention-law">President Obama Signs Indefinite Detention Into Law</a><br>Not the best news to start a new year with.</li>
<li><a href="http://www.theatlantic.com/national/archive/2011/12/what-americans-keep-ignoring-about-finlands-school-success/250564/">What Americans Keep Ignoring About Finland's School Success</a><br>Not only Americans keep ignoring this...</li>
<li><a href="http://www.antimon.org/code/Linus/">An Introduction to Programming C-64 Demos</a><br>The C-64 is the first computer I programed on, and since I just saw an awesome presentation about writing <a href="http://en.wikipedia.org/wiki/Demoscene">demos</a> for it, I'm getting a bit sentimental.</li>
<li><a href="http://www.wired.com/threatlevel/2011/12/civil-liberties-ip/">2011: The Year Intellectual Property Trumped Civil Liberties</a><br>Unfortunately this is a trend that can be seen world-wide, not only in the US.</li>
<li><a href="http://www.economist.com/node/21542227">Grief and fear</a><br>Some thoughts on Korea after Kim Jong-Il's death.</li>
</ul>


<p><blockquote><p>China, the only power with much influence over the country, is less troubled by the long-term grinding suffering of the North Koreans than by the prospect of a leadership vacuum leading suddenly to economic collapse and a flood of refugees. Such a prospect threatens to cause wider instability.</p><footer><strong>The Economist</strong> <cite><a href='http://www.economist.com/node/21542227'>Grief and Fear</a></cite></footer></blockquote></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Writing nmap scripts with Lua]]></title>
    <link href="http://citizen428.net/blog/2011/12/23/writing-nmap-scripts-with-lua/"/>
    <updated>2011-12-23T13:54:00+01:00</updated>
    <id>http://citizen428.net/blog/2011/12/23/writing-nmap-scripts-with-lua</id>
    <content type="html"><![CDATA[<p>About 2 weeks ago I finally started looking into <a href="http://www.lua.org/">Lua</a>, a language that's been on my radar for a while but that I never really got around to play with so far. Then I realized that the <a href="http://nmap.org/book/nse.html">Nmap Scripting Engine</a> uses Lua scripts, so I had an excuse to hack on this stuff for work. Here's my first small <code>nmap</code> script, which will extract the contents of the generator meta tag if there is one. It's nothing funky, but it shows how easy it is to write custom scripts for <code>nmap</code> thanks to the provided libraries like <code>http</code> and <code>shortport</code>.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class='lua'><span class='line'><span class="n">description</span> <span class="o">=</span> <span class="s">[[</span>
</span><span class='line'><span class="s">Displays the contents of the &quot;generator&quot; meta tag if there is one.</span>
</span><span class='line'><span class="s">]]</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">author</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="s">Michael Kohl&quot;</span>
</span><span class='line'><span class="n">license</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="s">Same as Nmap--See http://nmap.org/book/man-legal.html&quot;</span>
</span><span class='line'><span class="n">categories</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;</span><span class="s">discovery&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="s">safe&quot;</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c1">-- documentation skipped&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="nb">require</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">http&#39;</span><span class="p">)</span>
</span><span class='line'><span class="nb">require</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">shortport&#39;</span><span class="p">)</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">portrule</span> <span class="o">=</span> <span class="n">shortport</span><span class="p">.</span><span class="n">http</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">action</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
</span><span class='line'>   <span class="kd">local</span> <span class="n">response</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">generator</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>   <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="s1">&#39;</span><span class="s">/&#39;</span><span class="p">)</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>   <span class="c1">-- deal with redirects</span>
</span><span class='line'>   <span class="k">while</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;</span><span class="s">status-line&#39;</span><span class="p">]:</span><span class="n">lower</span><span class="p">():</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">&lt;sup&gt;http/1.1&lt;/sup&gt; 30[12]&quot;</span><span class="p">)</span> <span class="k">do</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span>  <span class="n">loc</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;</span><span class="s">location&#39;</span><span class="p">]</span>
</span><span class='line'>  <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="p">.</span><span class="n">get_url</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>   <span class="k">end</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>   <span class="k">for</span> <span class="n">line</span> <span class="k">in</span> <span class="n">response</span><span class="p">.</span><span class="n">body</span><span class="p">:</span><span class="n">gmatch</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">[&lt;sup&gt;</span><span class="se">\r\n</span><span class="s">]+&quot;</span><span class="p">)</span><span class="o">&lt;/</span><span class="n">sup</span><span class="o">&gt;</span> <span class="k">do</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span>  <span class="n">generator</span> <span class="o">=</span> <span class="n">line</span><span class="p">:</span><span class="n">match</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">&amp;lt;meta name=&quot;generator&quot; content=&quot;(.*)&quot; /&amp;gt;&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">if</span> <span class="n">generator</span> <span class="k">then</span>
</span><span class='line'>     <span class="k">return</span> <span class="n">generator</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>   <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><strong>Update:</strong> Here's the version that's now part of <code>nmap</code>, it even made it to the default category.</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
</pre></td><td class='code'><pre><code class='lua'><span class='line'><span class="n">description</span> <span class="o">=</span> <span class="s">[[</span>
</span><span class='line'><span class="s">Displays the contents of the &quot;generator&quot; meta tag if there is one.</span>
</span><span class='line'><span class="s">]]</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">author</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="s">Michael Kohl&quot;</span>
</span><span class='line'><span class="n">license</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="s">Same as Nmap--See http://nmap.org/book/man-legal.html&quot;</span>
</span><span class='line'><span class="n">categories</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;</span><span class="s">default&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="s">discovery&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="s">safe&quot;</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c1">-- documentation skipped&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="nb">require</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">http&#39;</span><span class="p">)</span>
</span><span class='line'><span class="nb">require</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">shortport&#39;</span><span class="p">)</span>
</span><span class='line'><span class="nb">require</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">stdnse&#39;</span><span class="p">)</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="c1">-- helper function</span>
</span><span class='line'><span class="kd">local</span> <span class="n">follow_redirects</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span><span class='line'>   <span class="kd">local</span> <span class="n">pattern</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="s">&lt;sup&gt;[hH][tT][tT][pP]/1.[01]&lt;/sup&gt; 30[12]&quot;</span>
</span><span class='line'>   <span class="kd">local</span> <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>   <span class="k">while</span> <span class="n">response</span><span class="p">[</span><span class="s1">&#39;</span><span class="s">status-line&#39;</span><span class="p">]:</span><span class="n">match</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">do</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span>  <span class="n">n</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>
</span><span class='line'>  <span class="n">loc</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;</span><span class="s">location&#39;</span><span class="p">]</span>
</span><span class='line'>  <span class="n">response</span> <span class="o">=</span> <span class="n">http</span><span class="p">.</span><span class="n">get_url</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>   <span class="k">end</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>   <span class="k">return</span> <span class="n">response</span>
</span><span class='line'><span class="k">end</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">portrule</span> <span class="o">=</span> <span class="n">shortport</span><span class="p">.</span><span class="n">http</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">action</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
</span><span class='line'>   <span class="kd">local</span> <span class="n">response</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">generator</span>
</span><span class='line'>   <span class="kd">local</span> <span class="n">path</span> <span class="o">=</span> <span class="n">stdnse</span><span class="p">.</span><span class="n">get_script_args</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">http-generator.path&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;</span><span class="s">/&#39;</span>
</span><span class='line'>   <span class="kd">local</span> <span class="n">redirects</span> <span class="o">=</span> <span class="nb">tonumber</span><span class="p">(</span><span class="n">stdnse</span><span class="p">.</span><span class="n">get_script_args</span><span class="p">(</span><span class="s1">&#39;</span><span class="s">http-generator.redirects&#39;</span><span class="p">))</span> <span class="ow">or</span> <span class="mi">3</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>   <span class="c1">-- Worst case: &lt;meta name=Generator content=&quot;Microsoft Word 11&quot;&gt;</span>
</span><span class='line'>   <span class="kd">local</span> <span class="n">pattern</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="s">&lt;meta name=&quot;?generator&quot;? content=&quot;([^</span><span class="se">\&quot;</span><span class="s">]*)&quot; ?/?&gt;&#39;</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>   <span class="c1">-- make pattern case-insensitive</span>
</span><span class='line'>   <span class="n">pattern</span> <span class="o">=</span> <span class="n">pattern</span><span class="p">:</span><span class="n">gsub</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">%a&quot;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span>           <span class="k">return</span> <span class="nb">string.format</span><span class="p">(</span><span class="s2">&quot;</span><span class="s">[%s%s]&quot;</span><span class="p">,</span> <span class="nb">string.lower</span><span class="p">(</span><span class="n">c</span><span class="p">),</span>
</span><span class='line'>                                          <span class="nb">string.upper</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
</span><span class='line'>         <span class="k">end</span><span class="p">)</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>   <span class="n">response</span> <span class="o">=</span> <span class="n">follow_redirects</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">redirects</span><span class="p">)</span>
</span><span class='line'>   <span class="k">return</span> <span class="n">response</span><span class="p">.</span><span class="n">body</span><span class="p">:</span><span class="n">match</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>
]]></content>
  </entry>
  
</feed>
