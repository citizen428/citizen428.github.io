
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>citizen428.blog()</title>
  <meta name="author" content="Michael Kohl">

  
  <meta name="description" content="This week Tom &mdash; who is now a happily married man :-) &mdash; and yours truly finally read another paper and since I&#8217;m sick and barely &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://citizen428.net/blog/page/9/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="citizen428.blog()" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<meta name="google-site-verification" content="bArHZu2u3n3GxMD_LR02GfyzeA-nYFOuaBuDbfJT07U" />
<meta name="verify-postrank" content="q9zqqyw" />
<link rel="openid.server" href="http://www.myopenid.com/server" />
<link rel="openid.delegate" href="http://citizen428.myopenid.com/" />

<script type="text/javascript">
/* <![CDATA[ */
    (function() {
        var s = document.createElement('script'), t = document.getElementsByTagName('script')[0];
        s.type = 'text/javascript';
        s.async = true;
        s.src = 'http://api.flattr.com/js/0.6/load.js?mode=auto';
        t.parentNode.insertBefore(s, t);
    })();
/* ]]> */
</script>


  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-1416057-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">citizen428.blog()</a></h1>
  
    <h2>Try to learn something about everything</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:citizen428.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about/">About</a></li>
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/talks_and_publications">Talks and Publications</a></li>
  <li><a href="/studynotes">Study Notes</a></li>
  <li><a href="/imprint/">Imprint</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/07/30/tom-and-michael-vs-the-good-grief-algorithm/">Tom and Michael vs the Good Grief Algorithm</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-07-30T00:00:00+02:00" pubdate data-updated="true">Jul 30<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>This week <a href="http://mrjaba.posterous.com/">Tom</a> &mdash; who is now a happily married man :-) &mdash; and yours truly finally read another paper and since I&#8217;m sick and barely left bed for the last 2 days I decided to fight my boredom by writing about it.</p>
<p><strong>The paper</strong><br />
&#8220;Multiple Aspect Ranking using the Good Grief Algorithm&#8221; by Benjamin Snyder and Regina Barzilay from the <span class="caps">MIT</span> CS and AI Lab.</p>
<ul>
<li><a href="http://people.csail.mit.edu/regina/my_papers/ggranker.ps">Paper</a></li>
<li><a href="http://pages.cs.wisc.edu/~bsnyder/presentations/naacl07.pdf">Presentation</a></li>
<li><a href="http://people.csail.mit.edu/bsnyder/naacl07/">Data and code</a></li>
</ul>
<p><strong>Summary</strong><br />
The paper is in the field of sentiment analysis &mdash; extracting opinions from a text &mdash; and uses restaurant reviews as a corpus. The prime assumption is that such texts will contain more than one opinion (e.g. quality of food, price range, interior, quality of service), which the authors believe is not properly reflected by previous work in this area, where one opinion per text is assumed.</p>
<p>The problem the authors try to solve is assigning a rank from a fixed scale (e.g. 1-5) to several related aspects. They dismiss the easy approach of treating every aspect as a separate ranking problem, since they believe that a real text relates the different aspects in a coherent way (e.g. through phrases like &#8220;but&#8221;, &#8220;one problem was&#8221; etc.).</p>
<p>They built on previous work in the natural language processing field, namely linear models trained with <a href="http://en.wikipedia.org/wiki/Perceptron">&#8220;Perceptron&#8221;</a> and extended this framework with a sort of &#8220;meta-model&#8221; that predicts relations (agreement or disagreement) between the individually ranked aspects. By relating the different aspects in such a way, it&#8217;s easier to reflect the contrasting views in real text like &#8220;good <span class="caps">BUT</span> pricey&#8221; in a meaningful way.</p>
<p>What follows is some math, where each input (a review) gets assigned an m-dimensional ranking vector (reflecting m aspects). For example if you try to rank 3 different aspects (food, service, price) on a scale of 1-5 a ranking vector might look like &lt;5,5,3&gt; (&#8220;food and service were great, but it was a bit pricey&#8221;). The joint ranking model then combines the individual ranks with an &#8220;agreement model&#8221; to introduce &#8220;grief terms&#8221; which express dissatisfaction in a certain aspect. The algorithm than tries to minimize the sum of this &#8220;grief&#8221; &mdash; which is what gave the algorithm its name &mdash; in a joint rank. This step then gets incorporated into the training of the individual rankers (there&#8217;s some pseudo-code for the joint training), where features of an aspect get represented through presence or absence of words and word <a href="http://en.wikipedia.org/wiki/Bigram">bigrams</a>. This is obviously a very simplified description of the algorithm, but it seems moot to repeat the entire math here, which is very well laid out in the presentation. There&#8217;s also a very nice illustration about decoding and relating the various aspects at the end of the <span class="caps">PDF</span>.</p>
<p>What then follows is a comparison of the Good Grief algorithm with similar algorithms on a corpus of 4500 restaurant reviews ranking restaurants on 5 different aspects, where it outperforms the &#8220;competition&#8221; in a statistically relevant way.</p>
<p><strong>Takeaway</strong><br />
As someone who works in an area where sentiment analyses could come in handy I do have an interest in the topic, but alas we don&#8217;t have the time and resources to develop our own system to do this properly. I once hacked something together with JRuby and the OpenNLP library, which wasn&#8217;t really sentiment analysis but an attempt to extract useful phrases from reviews. It was crude and had its faults, but worked surprisingly well for the amount of time it took to write. It did however get abandoned in a prototype stage and after reading the paper it&#8217;s quite clear to me that that probably was a good choice. Sentiment analysis is a non-trivial problem that can&#8217;t properly be tackled in the ad-hoc fashion we tried. Should this topic ever resurface at my company I&#8217;ll definitely try to go for a more elaborate and scientific approach.</p>
<p><strong>Difficulty of the paper</strong><br />
I know that for some people the math might look scary, but if you take some time and look at it carefully you&#8217;ll notice that it&#8217;s actually rather simple. It probably doesn&#8217;t hurt to be acquainted with some basic concepts of <span class="caps">NLP</span> and machine learning, but if you have those it&#8217;s quite an enjoyable paper even if you are not an absolute crack in the field.</p>
<p><strong>Further reading</strong></p>
<ul>
	<li><a href="http://en.wikipedia.org/wiki/Natural_language_processing">Natural language processing</a></li>
	<li><a href="http://en.wikipedia.org/wiki/Sentiment_analysis">Sentiment analysis</a></li>
	<li><a href="http://incubator.apache.org/opennlp/">OpenNLP</a></li>
</ul></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/07/24/information-overload-2011-07-24/">Information Overload 2011-07-24</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-07-24T00:00:00+02:00" pubdate data-updated="true">Jul 24<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><a href="http://online.wsj.com/article/SB10001424052702304911104576445862242908294.html?mod=WSJ_hp_mostpop_read">Why My Father Hated India</a><br>A half Indian/half Pakistani sheds some light on the animosity between the two countries.</li>
<li><a href="http://www.wired.com/magazine/2011/07/ff_khan/all/1">How Khan Academy Is Changing the Rules of Education</a><br>Very nice piece on the <a href="http://www.khanacademy.org/">Khan Academy</a>, including examples of how it&#8217;s used in class rooms as well as positive and negative feedback by educators.</li>
<li><a href="http://www.wired.com/magazine/2011/07/mf_chainworld/all/1">Chain World Videogame Was Supposed to be a Religion-Not a Holy War</a><br>Wow, I completely missed this last year, but this is a super-interesting piece on an even more interesting indie game.</li>
<li><a href="http://rahulbijlani.com/essays/you-are-not-running-out-of-time-essay/">You are not running out of time</a><br>This really resonates with me and judging from the comments I&#8217;m not the only one.</li>
<li><a href="http://www.guardian.co.uk/world/2011/jun/07/marching-with-the-slutwalkers">Marching with the SlutWalkers</a><br>A Guardian story on the <a href="http://en.wikipedia.org/wiki/SlutWalk">SlutWalk</a> protest marches that are causing debate amongst feminists. Because it fits the topic, here&#8217;s a picture of a sticker I took in Vienna not so long ago (it roughly translates to &#8220;the power of definition means that only the aggrieved can decide if sexual borders were crossed&#8221;):</li>
<div align="center"><img src="https://lh5.googleusercontent.com/-MmAHHFB4gTA/TiK_HvbSdwI/AAAAAAAAAPQ/q1JIrriJNCo/s912/11%2B-%2B1" /></div>
<li><a href="http://www.fastcodesign.com/1664508/apple-designer-creates-teaching-ui-that-kills-math-using-data-viz">Ex-Apple Designer Creates Teaching UI That &quot;Kills Math&quot; Using Data Viz</a><br>I&#8217;m almost jealous all these great math teaching tools didn&#8217;t exist when I went to school. Ok, I am jealous.</li>
<li><a href="http://willinglycrazy.blogspot.com/2011/07/why-i-talk-openly-about-deep-dark-hole.html" title="and why you should too">Why I talk openly about the deep dark hole I&#8217;m sitting in</a><br>For various reasons this affects me on a very personal level and I can only agree with the message of this post.</li>
<li><a href="http://www.heise.de/tp/artikel/29/29687/1.html">&quot;In 30 Jahren wird es keinen Kapitalismus mehr geben&quot;</a><br>Will capitalism really disappear within the next 30 years? Sometimes it definitely feels like it.</li>
<li><a href="http://www.physorg.com/news/2011-07-years-math-problem-falls.html">After almost 20 years, math problem falls</a><br>Interesting result about approximating something NP-complete without something P-complete which might have a huge impact in several disciplines, from engineering to economics.</li>
<li><a href="http://www.theatlantic.com/technology/archive/2011/07/keepin-it-cool-how-the-air-conditioner-made-modern-america/241892/">Keepin&#8217; It Cool: How the Air Conditioner Made Modern America</a><br>I&#8217;m not a big fan of ACs, but this article isn&#8217;t only about them, but about how one piece of technology can change the world in profound ways.</li>
</ul></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/07/23/haskell-a-summary-of-the-typeclassopedia/">Haskell: A Summary of the &#8220;Typeclassopedia&#8221;</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-07-23T00:00:00+02:00" pubdate data-updated="true">Jul 23<span>rd</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>In my current effort of trying to really learn and master Haskell, I spent the last two or so weeks reading the excellent <a href="http://www.haskell.org/haskellwiki/Typeclassopedia">Typeclassopedia</a> by Brent Yorgey. Since I probably will have to go through it a couple more times, I took notes in Emacs <a href="http://orgmode.org/">org-mode</a> and exported them to <span class="caps">HTML</span>. You can find the summary either on GitHub or here:</p>
<ul>
	<li><a href="https://github.com/citizen428/study-notes/tree/master/typeclassopedia">GitHub repo</a></li>
	<li><a href="http://typeclassopedia.citizen428.net/">Typeclassopedia on citizen428.net</a></li>
</ul></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/07/17/information-overload-2011-07-17/">Information Overload 2011-07-17</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-07-17T00:00:00+02:00" pubdate data-updated="true">Jul 17<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><a href="http://www.nytimes.com/2011/07/11/opinion/11Prager.html">How Seawater Can Power the World</a><br>Interesting <span class="caps">NYT</span> op-ed on the future of fusion energy.</li>
<li><a href="http://www.economist.com/node/18925855?story_id=18925855">Zoobotics</a><br>Robot researchers are modeling their creations after animals now, assuming that it&#8217;s hard to come up with a better design than evolution.</li>
<li><a href="http://charliepark.org/slopegraphs/">Edward Tufte&#8217;s &quot;Slopegraphs&quot;</a><br>I really like this under-used chart style, I think it conveys meaning very well.</li>
<li><a href="http://www.slate.com/id/2298871/pagenum/all/">Groundhog Decade</a><br>Very good piece on how Hollywood apparently is dead set on repeating the mistakes of the music industry.</li>
<li><a href="http://soft.vub.ac.be/~tvcutsem/whypls.html">Why Programming Languages?</a><br>A programming language researcher explains why there are so many different programming languages and why we&#8217;ll likely keep on seeing new ones.</li>
<li><a href="http://www.stanfordalumni.org/news/magazine/2011/julaug/features/spe.html">The Menace Within</a><br>40 years after the Stanford Prison Experiment some key players tell about their experience and what they took away from the experiment.</li>
<li><a href="http://youarenotsosmart.com/2011/07/07/misattribution-of-arousal/">Misattribution of Arousal</a><br>I love all those insights into how our brains work. This article deals with the misattribution of arousal (not only of the sexual kind) to other people.</li>
<li><a href="http://www.wired.com/threatlevel/2011/07/how-digital-detectives-deciphered-stuxnet/all/1">How Digital Detectives Deciphered Stuxnet, the Most Menacing Malware in History</a><br>If you have the slightest interest in IT security, you&#8217;ll love this article, but even if you usually don&#8217;t enjoy this topic the story still reads like the plot of a Hollywood movie.</li>
<li><a href="http://d-build.org/blog/?p=2128">Tower of David: 45 Floors of Favela Chic</a><br>One of Latin America&#8217;s tallest buildings is now squatted by around 2500 people, many of them escaping live on the streets.</li>
<li><a href="http://m.motherjones.com/politics/2011/05/indian-call-center-americanization">My Summer at an Indian Call Center</a><br>An American citizen works in an Indian call center for a summer.</li>
</ul></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/07/11/tom-and-michael-vs-prototypical-inheritance/">Tom and Michael vs Prototypical Inheritance</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-07-11T00:00:00+02:00" pubdate data-updated="true">Jul 11<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://mrjaba.posterous.com/">Tom</a> and I read another paper, this time on prototypical inheritance: <a href="http://selflanguage.org/documentation/published/organizing-programs.html">Organizing Programs Without Classes</a>. You can find his post <a href="http://mrjaba.posterous.com/organizing-programs-without-classes">here</a> and I have to admit that he also did almost the entire summary this time whereas I only added some minor things and code examples.</p>
<p><strong>Summary</strong></p>
<p><span class="caps">OOP</span> is a paradigm which uses &#8220;objects&#8221; to encapsulate behavior and state in a programming language. This can be accomplished in a few ways, two of the more popular being class based and prototype based object orientation. In class based object models (e.g. Java) a class will be written to define the behavior and state that the object will embody. A class can be inherited from and extended to provide new functionality. In prototype based object models (e.g. ECMAScript, Io), there are no classes, only objects which can be cloned and altered to provide new features. Here&#8217;s a quick comparison of the two approaches in Ruby and ECMAScript:</p>
<p>Ruby:<br />
<div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># define a class</span>
</span><span class='line'><span class="k">class</span> <span class="nc">Hello</span>
</span><span class='line'>   <span class="k">def</span> <span class="nf">hello</span>
</span><span class='line'>     <span class="nb">puts</span> <span class="s2">&quot;Hello&quot;</span>
</span><span class='line'>   <span class="k">end</span>
</span><span class='line'><span class="k">end</span> <span class="c1">#=&gt; nil</span>
</span><span class='line'><span class="c1"># create an object instance</span>
</span><span class='line'><span class="n">h</span> <span class="o">=</span> <span class="no">Hello</span><span class="o">.</span><span class="n">new</span> <span class="c1">#=&gt; #&lt;Hello:0x00000100a2f520&gt;</span>
</span><span class='line'><span class="c1"># call a method</span>
</span><span class='line'><span class="n">h</span><span class="o">.</span><span class="n">hello</span> <span class="c1">#=&gt; nil</span>
</span><span class='line'><span class="no">Hello</span>
</span></code></pre></td></tr></table></div></figure></div></notextile></p>
<p>ECMAScript:<br />
<div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="c1">// create object using a function</span>
</span><span class='line'><span class="kd">function</span> <span class="nx">Hello</span><span class="p">()</span> <span class="p">{</span> <span class="k">this</span><span class="p">.</span><span class="nx">hello</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Hello!&quot;</span><span class="p">)</span> <span class="p">}</span> <span class="p">};</span>
</span><span class='line'><span class="c1">// create instance</span>
</span><span class='line'><span class="nx">h</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Hello</span><span class="p">();</span>
</span><span class='line'><span class="nx">h</span><span class="p">.</span><span class="nx">hello</span><span class="p">();</span> <span class="c1">// pops up an alert</span>
</span><span class='line'><span class="c1">// alternatively we can use an object literal</span>
</span><span class='line'><span class="nx">h</span> <span class="o">=</span> <span class="p">{</span><span class="nx">hello</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Hello!&quot;</span><span class="p">)</span> <span class="p">}</span> <span class="p">};</span>
</span><span class='line'><span class="nx">h</span><span class="p">.</span><span class="nx">hello</span><span class="p">();</span>
</span></code></pre></td></tr></table></div></figure></div></notextile></p>
<p>Class based inheritance purports many organizational benefits. Do prototype based languages share them? The paper looks at each benefit in turn and shows approaches to add these features into classless languages or even improve upon them.</p>
<p><em>Behaviour Sharing:<br />
</em>In class based programming languages code re-use is easy, you can inherit from a class and you&#8217;ll get access to that class&#8217;s methods and member variables.</p>
<p>In prototype based languages a clone/copy method is written on a prototypical object which can define which data members and methods are copied to the new object. This idea can be refined to an object whose sole purpose is to supply behavior, a trait. This can be a parent object of the new object to provide its functionality. As this trait object is shared amongst all clones, any changes to it affect the clones, just as with the class and subclass of class based programming. Here&#8217;s an example on behavior sharing in a prototype based language (Io):</p>
<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">A</span> <span class="o">:=</span> <span class="nb">Object</span> <span class="nx">clone</span>
</span><span class='line'><span class="nx">A</span> <span class="nx">m</span> <span class="o">:=</span> <span class="nx">method</span><span class="p">(</span><span class="nx">write</span><span class="p">(</span><span class="s2">&quot;in A\n&quot;</span><span class="p">))</span>
</span><span class='line'><span class="nx">A</span> <span class="nx">m</span>
</span><span class='line'><span class="nx">B</span> <span class="o">:=</span> <span class="nx">A</span> <span class="nx">clone</span>
</span><span class='line'><span class="nx">B</span> <span class="nx">m</span>
</span></code></pre></td></tr></table></div></figure></div></notextile></p>
<p>This will print:<br />
<div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>in A
</span><span class='line'>in B
</span></code></pre></td></tr></table></div></figure></div></notextile></p>
<p><em>Representation Sharing:</em><br />
In class based languages, subclassing gives the child class access to the member variables of the parent, its representation. In prototype based languages, a trait object provides only behavior, not data. This job is performed by a prototype instance of the object, one every other object will be cloned from. Its clone method will copy across its data slots (member variables) with any default values the programmer has provided. This is called a &#8220;Data Parent&#8221;.</p>
<p>In Ruby:<br />
<div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">A</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span>
</span><span class='line'>    <span class="vi">@member</span> <span class="o">=</span> <span class="s2">&quot;fred&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'> <span class="k">def</span> <span class="nf">method_a</span>
</span><span class='line'>   <span class="nb">puts</span> <span class="s2">&quot;in A with </span><span class="si">#{</span><span class="vi">@member</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'> <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="k">class</span> <span class="nc">B</span> <span class="o">&lt;</span> <span class="n">A</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">method_b</span>
</span><span class='line'>    <span class="nb">puts</span> <span class="s2">&quot;in B with </span><span class="si">#{</span><span class="vi">@member</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">A</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">method_a</span>
</span><span class='line'><span class="n">B</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">method_b</span>
</span><span class='line'>
</span><span class='line'><span class="c1">#in A with fred</span>
</span><span class='line'><span class="c1">#in B with fred</span>
</span></code></pre></td></tr></table></div></figure></div></notextile></p>
<p>In IO:<br />
<div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">Food</span> <span class="o">:=</span> <span class="nb">Object</span> <span class="nx">clone</span>
</span><span class='line'>
</span><span class='line'><span class="nx">pizza</span> <span class="o">:=</span> <span class="nx">Food</span> <span class="nx">clone</span>
</span><span class='line'><span class="nx">pizza</span> <span class="nx">name</span> <span class="o">:=</span> <span class="s2">&quot;Meat Feast&quot;</span>
</span><span class='line'><span class="nx">pizza</span> <span class="nx">price</span> <span class="o">:=</span> <span class="mi">10</span>
</span><span class='line'>
</span><span class='line'><span class="nx">pasta</span> <span class="o">:=</span> <span class="nx">pizza</span> <span class="nx">clone</span>
</span><span class='line'><span class="nx">pasta</span> <span class="nx">name</span> <span class="o">=</span> <span class="s2">&quot;Macaroni Cheese&quot;</span>
</span><span class='line'><span class="nx">pasta</span> <span class="nx">price</span> <span class="o">=</span> <span class="mi">5</span>
</span></code></pre></td></tr></table></div></figure></div></notextile><br />
<em>Dynamic Behaviour Changes &#8211; Changing an instance&#8217;s class and dynamic inheritance:<br />
</em><em>Tom:</em> This was a section of particular interest, mainly because I think it&#8217;s not quite as skewed as they portray it. The idea is that because in a prototype based model the reference to the parent object (traits, data) is simply a reference it can be changed very easily depending on the state the object is in. This provides new functionality as the object goes through its life. In a class based model, changing an instance&#8217;s class is difficult at best and not a good idea, however the idea of changing behavior based on state is still a useful concept. The authors however seem to miss the concept of composition and delegation, it&#8217;s next to trivial to change the behavior of an object simply by changing the object that is providing a function, just take a look at the Strategy Pattern for an example.<br />
<em>Michael:</em> This paper is from 1991, the <a href="http://en.wikipedia.org/wiki/Design_Patterns">Gang of Four book on Design Patterns</a> from 1994, so I guess you&#8217;re blaming the authors for not knowing about something that hasn&#8217;t been published when they wrote their paper.<br />
<em>Tom:</em> Fair point! I wonder when the concept of delegation was first coined?<br />
<em>Michael:</em> According to <a href="http://en.wikipedia.org/wiki/Delegation_(programming)">Wikipedia</a> in a paper from 1986, &#8220;Using Prototypical Objects to Implement Shared Behavior in Object-Oriented Systems&#8221;.</p>
<p>In ECMAScript:<br />
<div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">circle</span><span class="p">(){}</span>
</span><span class='line'><span class="nx">circle</span><span class="p">.</span><span class="nx">prototype</span>
</span><span class='line'><span class="err">#</span><span class="nx">circle</span>
</span><span class='line'><span class="nx">circle</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">ellipse</span><span class="p">(){}</span>
</span><span class='line'><span class="nx">circle</span><span class="p">.</span><span class="nx">prototype</span>
</span><span class='line'><span class="err">#</span><span class="nx">ellipse</span>
</span></code></pre></td></tr></table></div></figure></div></notextile></p>
<p>Changing the prototype can entirely change the behavior of an object.</p>
<p><em>Naming and Categorising:<br />
</em>This feature is vital in any nontrivial system, without being able to find code to serve its purpose the programmer would be constantly rewriting the same code over and over. Class based languages tend to provide a globally accessible name for a set of functions. They also tend to provide namespaces to prevent naming collisions or categorisation. Prototype based languages need to be able to access the prototype anywhere in the system to be cloned, but as they are just regular objects, they have no internal names. The authors of the paper propose that namespace objects can be used to fill this need. Essentially a globally accessible hash map, which can contain nested namespace objects to provide categorisation. This later emerged as a fairly common pattern in ECMAScript.</p>
<p>In Ruby:<br />
<div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">A</span><span class="p">;</span> <span class="k">end</span>
</span><span class='line'><span class="n">A</span>
</span><span class='line'><span class="c1">#A</span>
</span></code></pre></td></tr></table></div></figure></div></notextile><br />
A is a globally defined constant which points to an Object.</p>
<p>In ECMAScript:<br />
<div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">TopLevel</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">TopLevel</span> <span class="o">||</span> <span class="p">{}</span>
</span><span class='line'><span class="nx">TopLevel</span><span class="p">.</span><span class="nx">SecondLevel</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(){</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">member</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
</span><span class='line'>  <span class="kd">function</span> <span class="nx">memberMethod</span><span class="p">(){</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></div></notextile></p>
<p>Note that TopLevel is simply an object literal.</p>
<p>The naming of these type of systems is highly dependent on the structure of the system, this type of naming is called Extensional naming. Intensional naming is the term given to systems where the name of classes is defined by the programmer and not necessarily related to the structure of the system. The authors claim that Extensional naming has a few key advantages:</p>
<p>1) It&#8217;s free with a classless language; no other constructs are required for this behaviour to work.<br />
2) The names are also expressions, and as this is code it can have additional interpretations.<br />
3) Intensional naming can become inconsistent quite easily.</p>
<p>Tom&#8217;s not convinced any of these reasons are actually advantages: 1) just because a system comes with a feature doesn&#8217;t mean you should use it if there is a better alternative available &#8211; prototype based models don&#8217;t seem to have much of an alternative. 2) because it is code and not a simple lookup this is more complicated and has more potential for error. 3) this is probably valid. Changing a class name does require it to be updated everywhere in the system, but with refactoring tools this is mitigated.</p>
<p><strong>Conclusion:<br />
</strong>This was a pretty interesting paper. Personally I&#8217;ve always been drawn to Io, but never got past the &#8220;playing around&#8221; stage with it. Checking out Self also is on my todo list. I think there&#8217;s a certain elegance to prototype based object orientation and I&#8217;d like to research it a bit more.</p>
<p><strong>Further reading:</strong><br />
<ul><li><a href="http://en.wikipedia.org/wiki/Self_(programming_language)" title="Self">Self</a></li><li><a href="http://en.wikipedia.org/wiki/Javascript" title="Javascript">Javascript</a></li><li><a href="http://en.wikipedia.org/wiki/Io_(programming_language)" title="Io">Io</a></li><li><a href="http://en.wikipedia.org/wiki/Prototype_based" title="Protoype based object orientation">Protoype based object orientation</a></li><li><a href="http://en.wikipedia.org/wiki/Trait_(computer_programming)" title="Trait">Trait</a></li></ul></p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/07/10/information-overload-2011-07-10/">Information Overload 2011-07-10</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-07-10T00:00:00+02:00" pubdate data-updated="true">Jul 10<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><a href="http://www.guardian.co.uk/technology/2011/jul/03/us-anti-piracy-extradition-prosecution">US anti-piracy body targets foreign website owners for extradition</a><br>Is anyone still shocked by news like this?</li>
<li><a href="http://www.newscientist.com/article/dn20649-exclusive-first-interview-with-key-lulzsec-hacker.html?full=true">Exclusive first interview with key LulzSec hacker</a><br>I&#8217;m not sure how legit this interview is, better make up your own mind.</li>
<li><a href="http://hobolobo.net/">Hobo Lobo of Hamelin</a><br>Awesome story-telling in <span class="caps">HTML</span>, <span class="caps">CSS</span> and JS. Can&#8217;t wait for the next part.</li>
<li><a href="http://www.bbc.co.uk/news/business-14025485">Who defaults first: Greece or the US?</a><br>With all the attention on Greece, it&#8217;s easy to overlook that the US are in a dire situation too.</li>
<li><a href="http://news.yahoo.com/portugal-drug-law-show-results-ten-years-experts-180013798.html">Portugal drug law show results ten years on, experts say</a><br>Unfortunately this is very unlikely to have any effect on the &#8220;War on Drugs&#8221;, but it&#8217;s good news nonetheless.</li>
<li><a href="http://openpcr.org/2011/07/dna-is-now-diy-openpcr-ships-worldwide/"><span class="caps">DNA</span> is now <span class="caps">DIY</span>: OpenPCR ships worldwide</a><br>Another very impressive achievement of the maker/<span class="caps">DIY</span> community.</li>
<li><a href="Comparing"><span class="caps">IRA</span> VS. Al Qaeda: I was wrong</a> the tactics of the <span class="caps">IRA</span> and Al Qaeda. Some interesting food for thought, but I&#8217;d encourage you to draw your own conclusions from the provided information (like always).<br></li>
<li><a href="http://www.huffingtonpost.com/2011/06/29/ap-associated-press-north-korea-bureau_n_887147.html">Associated Press Opening North Korea Bureau</a><br>Let&#8217;s see how this goes, but I&#8217;m cautiously optimistic about this.</li>
<li><a href="http://www.guardian.co.uk/world/interactive/2011/mar/22/middle-east-protest-interactive-timeline">Arab spring: an interactive timeline of Middle East protests</a><br>Another nice interactive infographic by the Guardian.</li>
<li><a href="http://www.physorg.com/news/2011-07-rhesus-monkeys-awareness-previously-attributed.html">Rhesus monkeys have a form of self awareness not previously attributed to them</a><br>There&#8217;s still so little we know about animals&#8230;</li>
</ul></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/07/07/review-learn-you-a-haskell-for-great-good/">Review: Learn You a Haskell for Great Good</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-07-07T00:00:00+02:00" pubdate data-updated="true">Jul 7<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><em>Disclaimer: <a href="http://www.nostarch.com/">No Starch Press</a> were nice enough to provide me with a free copy of the book reviewed here but what I&#8217;m about to write has not been influenced by this.</em></p>
<p>Properly learning Haskell has been on my todo list for years. One of my first more serious attempts was in 2009, when I found <a href="http://learnyouahaskell.com/">a weird little book with lots of cartoons online</a>. As you may have guessed that was Miran Lipovaca&#8217;s &#8220;Learn You a Haskell for Great Good&#8221; and I was immediately intrigued by the writing style and cute cartoons. However back then the book was still a work in progress and I eventually stopped reading it before Miran got around to adding the last chapters. I always promised myself to eventually revisit this later, so I was delighted when I found out that No Starch Press is actually releasing an offline version of the book! Here you can see the cover in its full cartoony glory:<br />
<img class="aligncenter" style="border-width: 2px; border-color: black; border-style: solid;" title="Learn You A Haskell cover" src="http://s3.amazonaws.com/files.posterous.com/teddythebear/1XvdQkcaG7iWYJB8XYQeLVwwt5VGYAcxGPa1PNdigVpx60HxVtEQphHTlXEI/LearnYouAHaskell.jpg?AWSAccessKeyId=AKIAJFZAE65UYRT34AOQ&Expires=1319408436&Signature=woTKJQqeEIU9zs1Ib3AfV64gtfY%3D" alt="Learn You A Haskell cover" width="170" height="225" align="centre" border="1" /></p>
<p>Before you think this book is all about funny drawings, lets talk about the real star, the content. <span class="caps">LYAH</span> definitely is among the top programming books I read so far. Due to the author&#8217;s easy-going and funny style &mdash; though I&#8217;m sure there will be some readers who won&#8217;t appreciate his humor &mdash; you might not even notice at first how choke-full of good content this book is, but once you are done with it you realize that you actually learned a lot. This would be an amazing feat for any technical book, but is even more impressive considering Haskell&#8217;s reputation as being a very academical and arcane language. Sure, not everything is covered here &mdash; Arrows or <span class="caps">CPS</span> come to mind &mdash; but every book is finite and the selection of topics is absolutely appropriate for beginning Haskell enthusiasts. The only chapter I wasn&#8217;t so happy with was the last one on <a href="http://en.wikipedia.org/wiki/Zipper">Zippers</a>, not because it wasn&#8217;t well written or interesting, but more because it felt a bit tucked on.</p>
<p>What can you expect from this book? Will you be a Haskell guru after reading it? Most likely not, because that takes a long time of practice and actually writing code. Maybe that&#8217;s one of the few weak points of <span class="caps">LYAH</span>, the code examples are usually rather short and focussed on getting the point across, not &#8220;real-world&#8221; tasks you are likely to encounter in day to day programming. They still are great for introducing the reader to Haskell&#8217;s way of abstracting problems, which I find immensely beautiful and well thought out. Still, a chapter or two on &#8220;programming in the large&#8221; and how to structure a big Haskell project would have been nice additions, but there are other places for learning more about the language, e.g. the <a href="http://www.haskell.org/haskellwiki/Haskell">Haskell wiki</a> or the <a href="https://encrypted.google.com/#hl=en&amp;q=haskell%20wikibook&amp;aq=f&amp;aqi=&amp;aql=&amp;oq=&amp;gs_rfai=&amp;fp=1&amp;bav=on.2,or.r_gc.r_pw.&amp;cad=b">Haskell Wikibook</a>. What the book will do for you is that once you are done with it, you should have a good basic understanding of the language&#8217;s key concepts and type system and will be comfortable around terms like &#8220;monoid&#8221;, &#8220;applicative functor&#8221; and &#8220;monad&#8221;. There still we be a long way to go before you can consider yourself a Haskell expert, but you&#8217;ll have a very solid grounding to build on.</p>
<p>All in all this is a remarkable book and maybe just what this beautiful language was missing, an easy to read, entertaining yet still thorough introduction to the language, that gives you an idea that Haskell is not only a research subject for computer scientists but a useful tool that can be used to build software.</p></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/07/03/information-overload-2011-07-03/">Information Overload 2011-07-03</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-07-03T00:00:00+02:00" pubdate data-updated="true">Jul 3<span>rd</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><a href="http://news.discovery.com/autos/new-car-engine-sends-shockwaves-through-auto-industry-110405.html">New Car Engine Sends Shock Waves Through Auto Industry</a><br>Interesting new concept for an energy-efficient engine, with a possible prototype by the end of the year.</li>
<li><a href="http://www.economist.com/blogs/dailychart/2011/06/diabetes">Sugar rush</a><br>Interesting info graphic on the increase of diabetes around the world. In Austria the last 30 years saw an increase of 30-46% for women and over 60% for men.</li>
<li><a href="http://smarterware.org/8248/what-google-learned-from-buzz-and-wave">What Google+ Learned from Buzz and Wave</a><br>Since Google+ is all the hype this week, I had to include an article on it. At least this one has some actual content.</li>
<li><a href="http://www.nature.com/news/2011/110628/full/news.2011.388.html">Pruney fingers grip better</a><br>The wringly fingers we get when bathing? There actually might be a good reason for that.</li>
<li><a href="http://blogs.forbes.com/artcarden/2011/06/30/time-to-close-the-security-theater/">Time to Close the Security Theater</a><br>This is Forbes quoting Bruce Schneier and calling for abolishing the <span class="caps">TSA</span>, while also suggesting &#8220;a competitive market for air travel in which the airports, the airways, and the airliners are in private hands&#8221;. I agree with one of the above two points, can you guess which? ;-)</li>
<li><a href="http://www.information.dk/272094">A Party that smiles to the world, but tightens its grip at home</a><br>Having lived in China, I&#8217;m always interested in what&#8217;s going on in the country. From what I saw on Twitter over the last few month, the document cited in this article may well be real.</li>
<li><a href="http://www.guardian.co.uk/world/2011/jun/09/us-drugs-oxycodone-painkillers-florida">Pharmageddon: how America got hooked on killer prescription drugs</a><br>While the headline is terrible, the article tackles a very real problem, prescription drug abuse in the US.</li>
<li><a href="http://hippomath.blogspot.com/2011/07/kempner-series-modified-harmonic-series.html">The Kempner Series &#8211; A modified harmonic series</a><br>Interesting how little it takes to make the harmonic series convergent.</li>
<li><a href="http://derstandard.at/1308679612170/Suedspanien-Dasein-unter-Plastikmuell">Dasein unter Plastikm&uuml;ll</a><br>An interview about the situation of migrant workers in Almeria. Is this what the European Union wants to stand for? (in German)</li>
<li><a href="http://www.nytimes.com/2011/04/17/magazine/mag-17Sugar-t.html?_r=3&amp;pagewanted=all">Is Sugar Toxic?</a><br>Now that people are getting wary of H.F.C.S., some scientists start suspecting that &#8220;normal&#8221; sugar isn&#8217;t much better.</li>
</ul></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/06/26/information-overload-2011-06-26/">Information Overload 2011-06-26</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-06-26T00:00:00+02:00" pubdate data-updated="true">Jun 26<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><a href="http://sivers.org/fish">Fish don&#8217;t know they&#8217;re in water</a><br>This is something I also learned while traveling, the further you go away from home, the more you realize that many things you take as granted are just part of your own culture.</li>
<li><a href="http://online.wsj.com/article/SB10001424052702304432304576369421525987128.html?mod=WSJ_hps_sections_opinion">Don&#8217;t Know Much About History</a><br>While I hope that history lessons in Europe aren&#8217;t as bad as they apparently are in the US, I remember from my own high-school days that the subject is often taught in awful ways.</li>
<li><a href="http://en.wikipedia.org/wiki/G%C3%B6mb%C3%B6c#Name">The story of the G&ouml;mb&ouml;c</a><br>This is why math is cool: what starts as a weird theory, is later discovered to actually exist in nature.</li>
<li><a href="http://www.coolmagnetman.com/maghow.htm">How do magnets work?</a><br>A very nice explanation of magnetism.</li>
<li><a href="http://www.cs.utexas.edu/users/EWD/ewd08xx/EWD831.PDF">Why numbering should start at zero</a><br>A letter by Edsger W. Dykstra gives a reason for why array indexing should start with 0 (&#8220;an element&#8217;s ordinal (subscript) equals the number of elements preceding it in the sequence&#8221;).</li>
<li><a href="http://singularityhub.com/2011/06/22/new-japanese-pop-idol-shocks-fans-with-news%E2%80%93shes-not-real-video/">New Japanese Pop Idol Shocks Fans With News &mdash; She&#8217;s Not Real</a><br>With the amount of crazy news coming out of Japan, it&#8217;s surprising the country doesn&#8217;t feature here more regularly.</li>
<li><a href="http://www.economist.com/content/indian-summary">An Indian summary</a><br>Great visualization of Indian states compared to countries. Maharashtra for example has the <span class="caps">GDP</span> of Singapore, but a per head roughly like Sri Lanka.</li>
<li><a href="http://www.spiegel.de/international/europe/0,1518,769831,00.html">How European Elites Lost a Generation</a><br>A good article to understand some of the motivations behind the protests of young people everywhere in Europe.</li>
<li><a href="http://www.economist.com/node/18866885">Lucky Yingluck</a><br>With the Thai elections around the corner, this article provides some insights into the current election campaign.</li>
<li><a href="http://www.salon.com/news/opinion/glenn_greenwald/2011/06/01/free_speech">Criminalizing free speech</a><br>On free speech and extra-legal killings.</li>
</ul></div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/06/24/ruby-going-to-c-side/">Ruby: Going to the C Side</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2011-06-24T00:00:00+02:00" pubdate data-updated="true">Jun 24<span>th</span>, 2011</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Yesterday afternoon I decided it&#8217;s about time I finally learn how to write Ruby C extensions, so I went ahead and rewrote one of our <a href="http://www.rubylearning.org/class/">RubyLearning.org</a> exercises in C. Here&#8217;s the exercise description:</p>
<blockquote><p>Write a class called Person, that has balance as an instance variable and<br/>the following public method: show_balance.</p><p>I shall create the Person object as follows:</p><p>p = Person.new(40000)<br/>puts p.show_balance # calling the method</p></blockquote>
<p>Here&#8217;s the program in C, with relevant function signatures included as comments:</p>
<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="cp">#include &lt;ruby.h&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="k">static</span> <span class="n">VALUE</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">VALUE</span> <span class="n">self</span><span class="p">,</span> <span class="n">VALUE</span> <span class="n">amount</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// VALUE rb_iv_set(VALUE obj, char *name, VALUE value)</span>
</span><span class='line'>  <span class="n">rb_iv_set</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="s">&quot;@balance&quot;</span><span class="p">,</span> <span class="n">amount</span><span class="p">);</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">self</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">static</span> <span class="n">VALUE</span> <span class="nf">show_balance</span><span class="p">(</span><span class="n">VALUE</span> <span class="n">self</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// VALUE rb_iv_get(VALUE obj, char *name)</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">rb_iv_get</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="s">&quot;@balance&quot;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kt">void</span> <span class="nf">Init_person</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// VALUE rb_define_class(char *name, VALUE superclass)</span>
</span><span class='line'>  <span class="n">VALUE</span> <span class="n">cPerson</span> <span class="o">=</span> <span class="n">rb_define_class</span><span class="p">(</span><span class="s">&quot;Person&quot;</span><span class="p">,</span> <span class="n">rb_cObject</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">// void rb_define_method(VALUE classmod, char *name, VALUE(*func)(), int argc)</span>
</span><span class='line'>  <span class="n">rb_define_method</span><span class="p">(</span><span class="n">cPerson</span><span class="p">,</span> <span class="s">&quot;initialize&quot;</span><span class="p">,</span> <span class="n">initialize</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>  <span class="n">rb_define_method</span><span class="p">(</span><span class="n">cPerson</span><span class="p">,</span> <span class="s">&quot;show_balance&quot;</span><span class="p">,</span> <span class="n">show_balance</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></div></notextile></p>
<p>I think the code is very self-explanatory, almost like writing Ruby in C. As you can see we define a class called &#8220;Person&#8221; in the &#8220;Init_person&#8221; function (which is called by Ruby when it loads our module), where we add the functions as instance methods with &#8220;rb_define_method&#8221;. To compile this, we need an extconf.rb, which contains the following:</p>
<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="n">require</span> <span class="err">&#39;</span><span class="n">mkmf</span><span class="err">&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">extension_name</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">person</span><span class="err">&#39;</span>
</span><span class='line'><span class="n">create_makefile</span><span class="p">(</span><span class="n">extension_name</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></div></notextile></p>
<p>Now we can build and run it:</p>
<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>→ ruby extconf.rb
</span><span class='line'>creating Makefile
</span><span class='line'>→ make
</span><span class='line'>gcc -I. <span class="o">[</span>output snipped<span class="o">]</span>
</span><span class='line'>→ irb
</span><span class='line'>&gt;&gt; <span class="nv">$:</span>&lt;&lt;<span class="s1">&#39;.&#39;</span> <span class="c">#=&gt; [..., &#39;.&#39;]</span>
</span><span class='line'>&gt;&gt; require <span class="s1">&#39;person&#39;</span> <span class="c">#=&gt; true</span>
</span><span class='line'>&gt;&gt; <span class="nv">p</span> <span class="o">=</span> Person.new<span class="o">(</span>3000<span class="o">)</span> <span class="c">#=&gt; #&lt;Person:0x00000100a01940 @balance=3000&gt;</span>
</span><span class='line'>&gt;&gt; p.show_balance <span class="c">#=&gt; 3000</span>
</span></code></pre></td></tr></table></div></figure></div></notextile></p>
<p>As you can see everything works as if we had defined the class in Ruby. Let&#8217;s add another method to deposit some money, which gives us a chance to demonstrate &#8220;rb_funcall&#8221;:</p>
<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="k">static</span> <span class="n">VALUE</span> <span class="nf">deposit</span><span class="p">(</span><span class="n">VALUE</span> <span class="n">self</span><span class="p">,</span> <span class="n">VALUE</span> <span class="n">amount</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// VALUE rb_funcall(VALUE recv, ID id, int argc, ... )</span>
</span><span class='line'>  <span class="n">VALUE</span> <span class="n">result</span> <span class="o">=</span> <span class="n">rb_funcall</span><span class="p">(</span><span class="n">rb_iv_get</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="s">&quot;@balance&quot;</span><span class="p">),</span> <span class="n">rb_intern</span><span class="p">(</span><span class="s">&quot;+&quot;</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">amount</span><span class="p">);</span>
</span><span class='line'>  <span class="n">rb_iv_set</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="s">&quot;@balance&quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
</span><span class='line'>  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></div></notextile></p>
<p>We also need to add this function as a method in &#8220;Init_person&#8221;:</p>
<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'> <span class="n">rb_define_method</span><span class="p">(</span><span class="n">cPerson</span><span class="p">,</span> <span class="s">&quot;deposit&quot;</span><span class="p">,</span> <span class="n">deposit</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure></div></notextile></p>
<p>Does it work?</p>
<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&gt;&gt;</span> <span class="nb">p</span><span class="o">.</span><span class="n">deposit</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span> <span class="c1">#=&gt; 3400</span>
</span></code></pre></td></tr></table></div></figure></div></notextile></p>
<p>It does and we&#8217;ve successfully created a Ruby class from C. Probably not the type of class you&#8217;d really implement this way, but good enough as an example.</p>
<p>Recommended reading:</p>
<ul>
<li><a href="http://www.ruby-doc.org/docs/ProgrammingRuby/html/ext_ruby.html">Extending Ruby</a> from the PickAxe</li>
<li>Mark Volkmann&#8217;s presentation <a href="http://java.ociweb.com/mark/NFJS/RubyCExtensions.pdf">Ruby C Extensions</a></li>
</ul></div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/10/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/8/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About citizen428</h1>
  <p>I&#8217;m Michael Kohl, generally known as citizen428 online. I mainly
  write about programming, and do a regular <a href="/blog/categories/informationoverload/">blog post series</a> collecting interesting
  articles I enjoyed throughout the week.</p>
<div id="social_media_icons" align="center">
<a href="http://twitter.com/citizen428"><img src="/images/icons/twitter.png"
                                             alt="Twitter" /></a>
<a href="https://plus.google.com/u/0/101046237539584353961/posts"><img src="/images/icons/google.png"
                                             alt="Twitter"
                                             /></a>
<a href="http://www.linkedin.com/in/citizen428"><img src="/images/icons/linkedin.png"
                                             alt="Twitter" /></a>
</div>
</section>

<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("citizen428", 3, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/citizen428" class="twitter-follow-button" data-show-count="true">Follow @citizen428</a>
  
</section>


<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/citizen428">@citizen428</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'citizen428',
            count: 3,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Michael Kohl -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'citizen428-blog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
